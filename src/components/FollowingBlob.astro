<Fragment>
  <div
    class="transform-gpu opacity-25 lg:blob motion-reduce:hidden dark:opacity-20 lg:animate-rotate-and-grow"
    id="blob"
    aria-hidden="true"
  >
  </div>
  <div
    class="transform-gpu lg:blur motion-reduce:hidden"
    id="blur"
    aria-hidden="true"
  >
  </div>
</Fragment>

<script is:inline>
  const blob = document.getElementById("blob");
  const blur = document.getElementById("blur");

  function throttle(callback, delay) {
    let lastTime = 0;
    return function () {
      const currentTime = new Date().getTime();
      if (currentTime - lastTime >= delay) {
        callback.apply(null, arguments);
        lastTime = currentTime;
      }
    };
  }

  // Blob size multiplier for offset calculation
  const BLOB_OFFSET_MULTIPLIER = 1.5;
  const ANIMATION_DURATION = 3000;

  window.onpointermove = throttle((event) => {
    if (!blob || !blur) return;

    const { clientX, clientY } = event;
    const blobWidth = blob.clientWidth || 0;
    const blobHeight = blob.clientHeight || 0;

    const x = clientX - blobWidth * BLOB_OFFSET_MULTIPLIER;
    const y = clientY - blobHeight + window.scrollY;

    blob.animate(
      {
        transform: `translate(${x}px, ${y}px)`,
      },
      { duration: ANIMATION_DURATION, fill: "forwards" },
    );

    blur.animate(
      {
        transform: `translate(${0}px, ${y}px)`,
      },
      { duration: ANIMATION_DURATION, fill: "forwards" },
    );
  }, 100);
</script>
