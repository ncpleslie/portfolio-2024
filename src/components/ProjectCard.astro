---
import { Image } from "astro:assets";
import { type Project } from "../hooks/useContent.hook";
import IconLinkBtn from "./IconLinkBtn.astro";
import Card from "./Card.astro";

interface Props {
  project: Project;
  lazyLoad?: boolean;
}

const { project, lazyLoad } = Astro.props;
---

<Card
  class="flex flex-col"
  aria-labelledby={`project-${project.title
    .replace(/\s+/g, "-")
    .toLowerCase()}`}
>
  {
    project.imageUrl && (
      <Image
        class="aspect-video h-full w-full rounded-xl object-contain drop-shadow-md transition-all duration-500 group-hover:md:scale-[1.03]"
        height="310"
        width="552"
        alt={`Screenshot showing ${project.title} project interface`}
        decoding="async"
        loading={lazyLoad ? "lazy" : "eager"}
        src={project.imageUrl}
      />
    )
  }
  <div class="flex flex-col gap-2">
    <h3
      id={`project-${project.title.replace(/\s+/g, "-").toLowerCase()}`}
      class="text-xl"
    >
      {project.title}
    </h3>
    <ul class="flex flex-wrap gap-2 text-sm" aria-label="Technologies used">
      {
        project.technologies.map((tech) => (
          <li class="rounded border-2 p-2 font-bold uppercase group-hover:bg-gray-50 dark:group-hover:bg-slate-600">
            {tech}
          </li>
        ))
      }
    </ul>
  </div>
  <p class="max-w-prose text-slate-800 dark:text-gray-200">
    {project.description}
  </p>
  <div
    class="items-flex-wrap flex w-full flex-grow flex-wrap items-center gap-2"
  >
    {
      project.githubUrl && (
        <IconLinkBtn
          external
          href={project.githubUrl || ""}
          title="See this project on GitHub"
          aria-label={`View ${project.title} source code on GitHub`}
          icon="simple-icons:github"
          class="group-hover:bg-white dark:bg-slate-600 dark:lg:bg-transparent"
        >
          GitHub
        </IconLinkBtn>
      )
    }

    {
      project.projectUrl && (
        <IconLinkBtn
          external
          href={project.projectUrl}
          title="See this project in action"
          aria-label={`Visit ${project.title} live website`}
          icon="mdi:external-link"
          class="group-hover:bg-white dark:bg-slate-600 dark:lg:bg-transparent"
        >
          View site
        </IconLinkBtn>
      )
    }
  </div>
</Card>
