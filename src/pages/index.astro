---
import Layout from "../layout/Layout.astro";
import Hero from "../components/Hero.astro";
import Navbar from "../components/Navbar.astro";
import Projects from "../components/projects/Projects.astro";
import WorkHistory from "../components/WorkHistory.astro";
import useContent from "../hooks/useContent.hook";
import IconLinkBtn from "../components/ui/IconLinkBtn.astro";
import Contact from "../components/Contact.astro";

export const prerender = true;

const { getShowcaseProjects, getWorkHistory, getDetails } = useContent();
const projects = await getShowcaseProjects();
const workHistory = await getWorkHistory();
const details = await getDetails();

const navbarLinks = [
  {
    title: "Projects",
    link: "#projects",
    id: "projects",
    icon: "mdi:card-bulleted-settings",
    alt: `See ${details.firstName}'s projects`,
  },
  {
    title: "Résumé",
    link: "#resume",
    id: "resume",
    icon: "mdi:resume",
    alt: `Check out ${details.firstName}'s Résumé`,
  },
  {
    title: "Contact",
    link: "#contact",
    id: "contact",
    icon: "mdi:email",
    alt: `Contact ${details.firstName}`,
  },
];
---

<Layout>
  <div class="my-32 grid grid-cols-1 gap-16 md:gap-8 lg:grid-cols-2">
    <Hero class="grid-span-1 col-start-1 lg:fixed" details={details}>
      <Navbar links={navbarLinks} />
    </Hero>
    <div class="grid-span-1 col-start-1 lg:col-start-2">
      <section aria-labelledby="about-heading">
        <h2 id="about-heading" class="sr-only">About Me</h2>
        <div class="mb-6 flex w-full flex-col items-center">
          <div class="flex max-w-prose flex-col gap-4 md:pl-4">
            <Fragment set:html={details.descriptionHtml} />
            {
              details.keyTechnologies && details.keyTechnologies.length > 0 && (
                <div class="mt-4">
                  <h3 class="mb-3 text-lg font-semibold">Key Technologies</h3>
                  <div class="flex flex-wrap gap-2">
                    {details.keyTechnologies.map((tech) => (
                      <span class="bg-bg-secondary text-text-secondary rounded-md px-3 py-1 text-sm font-medium">
                        {tech}
                      </span>
                    ))}
                  </div>
                </div>
              )
            }
          </div>
        </div>
      </section>
      <section
        class="mt-24 flex justify-center md:mt-16"
        id="projects"
        aria-labelledby="projects-heading"
      >
        <div class="flex max-w-[592px] flex-col items-center gap-8">
          <h2 id="projects-heading" class="sr-only">Featured Projects</h2>
          <Projects projects={projects} />
          <IconLinkBtn
            href="/projects"
            title="See more projects"
            aria-label="View all projects including corporate work"
            icon="ep:right"
            class="dark:from-bg-secondary dark:to-bg-secondary w-full bg-gradient-to-r from-blue-100 to-purple-100 text-base font-semibold md:text-lg"
          >
            View more projects including corporate work
          </IconLinkBtn>
        </div>
      </section>
      <section
        class="mt-24 flex justify-center md:mt-16"
        id="resume"
        aria-labelledby="resume-heading"
      >
        <div class="flex max-w-[592px] flex-col items-center gap-8">
          <h2 id="resume-heading" class="sr-only">Work Experience</h2>
          <WorkHistory workHistory={workHistory} />
          <IconLinkBtn
            href={"/resume"}
            title="See Résumé"
            aria-label="View full résumé document"
            icon="ep:right"
            class="dark:from-bg-secondary dark:to-bg-secondary w-full bg-gradient-to-r from-blue-100 to-purple-100 text-base font-semibold md:text-lg"
            external
          >
            View full résumé
          </IconLinkBtn>
        </div>
      </section>
      <section
        class="mt-16 flex flex-col justify-center gap-8"
        id="contact"
        aria-labelledby="contact-heading"
      >
        <h2 id="contact-heading" class="sr-only">Contact</h2>
        <Contact email={details.contactEmail} />
      </section>
    </div>
  </div>
</Layout>
